{"version":3,"file":"price-history-_MEUS0l3.js","sources":["../../../app/administration/src/module/sw-product/page/sw-product-detail/sw-product-detail.html.twig","../../../app/administration/src/module/sw-product/page/sw-product-detail/index.js","../../../app/administration/src/module/sw-product/view/af-price-watcher/price-history.html.twig","../../../app/administration/src/module/sw-product/view/af-price-watcher/index.js","../../../app/administration/src/module/sw-product/index.js"],"sourcesContent":["{% block sw_product_detail_content_tabs_additional %}\n    {% parent %}\n    {% block sw_product_detail_content_tabs_price_history %}\n        <sw-tabs-item :route=\"{ name: 'price.history', params: { id: $route.params.id } }\" title=\"Preisentwicklung\">\n            Preisentwicklung\n        </sw-tabs-item> \n    {% endblock %}\n{% endblock %}\n","import template from './sw-product-detail.html.twig';\n\nShopware.Component.override('sw-product-detail', {\n    template\n})\n","<div>\n    <sw-card title=\"Preisentwicklung\">\n        <div class=\"custom-chart-page\">\n            <sw-chart\n                    :type=\"'line'\"\n                    :series=\"[\n                             {\n                             name: 'Preis',\n                             data:products\n                             },\n                             ]\"\n                    :options=\"{\n                              title: {\n                                  text: 'Verkaufspreis'\n                              },\n                              xaxis: {\n                                  type: 'datetime',\n                                  min: minimum,\n                                  {#max: 1559952000000#}\n                              },\n                              yaxis: {\n                                  min:0,\n                                  tickAmount:3,\n                                  labels:{\n                                      formatter: (value) => { \n                                          return value\n                                      }\n                                  }\n                              }\n                              }\"\n                    :fillEmptyValues=\"day\"\n                    :sort=\"true\">\n            </sw-chart>\n            <sw-chart\n                    :type=\"'line'\"\n                    :series=\"[\n                             {\n                             name: 'Preis',\n                             data:ekproducts\n                             },\n                             ]\"\n                    :options=\"{\n                              title: {\n                                  text: 'Einkaufspreis'\n                              },\n                              xaxis: {\n                                  type: 'datetime',\n                                  min: ekminimum,\n                                  {#max: 1559952000000#}\n                              },\n                              yaxis: {\n                                  min:0,\n                                  tickAmount:3,\n                                  labels:{\n                                      formatter: (value) => { \n                                          return value\n                                      }\n                                  }\n                              }\n                              }\"\n                    :fillEmptyValues=\"day\"\n                    :sort=\"true\">\n            </sw-chart>\n        </div>\n    </sw-card>\n</div>\n","import template from './price-history.html.twig';\nconst { Criteria } = Shopware.Data;\nShopware.Component.register('price-history', {\n    template,\n    inject:[\n        'repositoryFactory'\n    ],\n\n    data: function () {\n        return {\n            minimum : undefined,\n            products: [],\n            ekminimum : undefined,\n            ekproducts: [],\n\n            result: undefined,\n            repository: undefined\n        }\n    },\n    computed: {\n        routeId(){\n            return this.$route.params.id;\n        },\n        priceHistoryRepository() {\n            // create a repository for the `product` entity\n            return this.repositoryFactory.create('price_history');\n        },\n        purchasePriceHistoryRepository() {\n            // create a repository for the `product` entity\n            return this.repositoryFactory.create('purchase_price_history');\n        },\n    },\n    metaInfo() {\n        return {\n            title: 'Preisentwicklung'\n        };\n    },\n\n    created(){\n        const criteria = new Criteria();\n        criteria.addFilter(\n            Criteria.equals('productId', this.routeId)\n        );\n        criteria.addSorting(\n            Criteria.sort('changeDate', 'ASC')\n        );\n        let counter = 0;\n        this.priceHistoryRepository\n            .search(criteria, Shopware.Context.api)\n            .then(result => {\n                result.forEach(res =>{\n                    if(counter === 0){\n                        this.minimum = new Date(res.createdAt).getTime()\n                    }\n                    counter = counter + 1\n                    let product = {\n                        \"x\" : new Date(res.createdAt).getTime(),\n                        \"y\" : res.newPrice[0].gross\n                    };\n                    this.products.push(product)\n                })\n                this.result = result;\n            });\n        let c = 0;\n        this.purchasePriceHistoryRepository\n            .search(criteria, Shopware.Context.api)\n            .then(result =>{\n                console.error(result);\n                result.forEach(res =>{\n                    if(c === 0){\n                        this.ekminimum = new Date(res.createdAt).getTime()\n                    }\n                    c = c + 1\n                    let ekproduct = {\n                        \"x\" : new Date(res.createdAt).getTime(),\n                        \"y\" : res.newPrice[0].gross\n                    };\n                    this.ekproducts.push(ekproduct)\n                })\n            })\n    },\n\n    methods: {\n    }\n});\n","import './page/sw-product-detail';\nimport './view/af-price-watcher';\n\n// Here you create your new route, refer to the mentioned guide for more information\nShopware.Module.register('af-price-watcher-tab', {\n    routeMiddleware(next, currentRoute) {\n        const customRouteName = 'price.history';\n    \n        if (\n            currentRoute.name === 'sw.product.detail' \n            && currentRoute.children.every((currentRoute) => currentRoute.name !== customRouteName)\n        ) {\n            currentRoute.children.push({\n                name: customRouteName,\n                path: '/sw/product/detail/:id/pricehistory',\n                component: 'price-history',\n                meta: {\n                    parentPath: 'sw.product.index'\n                }\n            });\n        }\n        next(currentRoute);\n    }\n});\n"],"names":["template$1","template","Criteria","criteria","counter","result","res","product","c","ekproduct","next","currentRoute","customRouteName"],"mappings":"AAAA,MAAAA,EAAe,0SCEf,SAAS,UAAU,SAAS,oBAAqB,CACjD,SAAIC,CACJ,CAAC,ECJD,MAAAA,EAAe,wuBCCT,CAAE,SAAAC,CAAQ,EAAK,SAAS,KAC9B,SAAS,UAAU,SAAS,gBAAiB,CACzC,SAAAD,EACA,OAAO,CACH,mBACR,EAEI,KAAM,UAAY,CACd,MAAO,CACH,QAAU,OACV,SAAU,CAAA,EACV,UAAY,OACZ,WAAY,CAAA,EAEZ,OAAQ,OACR,WAAY,MACxB,CACA,EACI,SAAU,CACN,SAAS,CACL,OAAO,KAAK,OAAO,OAAO,EACtC,EACQ,wBAAyB,CAErB,OAAO,KAAK,kBAAkB,OAAO,eAAe,CAChE,EACQ,gCAAiC,CAE7B,OAAO,KAAK,kBAAkB,OAAO,wBAAwB,CACzE,CACA,EACI,UAAW,CACP,MAAO,CACH,MAAO,kBACnB,CACA,EAEI,SAAS,CACL,MAAME,EAAW,IAAID,EACrBC,EAAS,UACLD,EAAS,OAAO,YAAa,KAAK,OAAO,CACrD,EACQC,EAAS,WACLD,EAAS,KAAK,aAAc,KAAK,CAC7C,EACQ,IAAIE,EAAU,EACd,KAAK,uBACA,OAAOD,EAAU,SAAS,QAAQ,GAAG,EACrC,KAAKE,GAAU,CACZA,EAAO,QAAQC,GAAM,CACdF,IAAY,IACX,KAAK,QAAU,IAAI,KAAKE,EAAI,SAAS,EAAE,QAAO,GAElDF,EAAUA,EAAU,EACpB,IAAIG,EAAU,CACV,EAAM,IAAI,KAAKD,EAAI,SAAS,EAAE,QAAO,EACrC,EAAMA,EAAI,SAAS,CAAC,EAAE,KAC9C,EACoB,KAAK,SAAS,KAAKC,CAAO,CAC9C,CAAiB,EACD,KAAK,OAASF,CAC9B,CAAa,EACL,IAAIG,EAAI,EACR,KAAK,+BACA,OAAOL,EAAU,SAAS,QAAQ,GAAG,EACrC,KAAKE,GAAS,CACX,QAAQ,MAAMA,CAAM,EACpBA,EAAO,QAAQC,GAAM,CACdE,IAAM,IACL,KAAK,UAAY,IAAI,KAAKF,EAAI,SAAS,EAAE,QAAO,GAEpDE,EAAIA,EAAI,EACR,IAAIC,EAAY,CACZ,EAAM,IAAI,KAAKH,EAAI,SAAS,EAAE,QAAO,EACrC,EAAMA,EAAI,SAAS,CAAC,EAAE,KAC9C,EACoB,KAAK,WAAW,KAAKG,CAAS,CAClD,CAAiB,CACjB,CAAa,CACb,EAEI,QAAS,CACb,CACA,CAAC,EChFD,SAAS,OAAO,SAAS,uBAAwB,CAC7C,gBAAgBC,EAAMC,EAAc,CAChC,MAAMC,EAAkB,gBAGpBD,EAAa,OAAS,qBACnBA,EAAa,SAAS,MAAOA,GAAiBA,EAAa,OAASC,CAAe,GAEtFD,EAAa,SAAS,KAAK,CACvB,KAAMC,EACN,KAAM,sCACN,UAAW,gBACX,KAAM,CACF,WAAY,kBAChC,CACA,CAAa,EAELF,EAAKC,CAAY,CACzB,CACA,CAAC"}